(()=>{"use strict";let e=document.querySelector("#timer"),t=document.querySelector("#quoteDisplay"),r=document.querySelector("#inputQuote"),c=document.querySelector("#percentage"),s=document.querySelector(".characters-per-second"),a=document.querySelector("#percentageSpaces"),n=document.querySelector(".characters-per-second-spaces"),i=document.querySelector("#error"),o=document.querySelector("#restart"),l;r.focus();let u=()=>fetch("https://api.quotable.io/random").then(e=>e.json()).then(e=>e.content),d=(e,t,r)=>{e.value=t,e.disabled=r},$=e=>e.split(""),h=e=>(t.innerHTML="",d(r,"",!1),e.forEach(e=>{let r=document.createElement("span");r.innerText=e,t.appendChild(r)}),t),p=async()=>{try{let e=await h($(await u()));(l=e.querySelectorAll("span"))[0].classList.add("active-character")}catch(t){v(i,!0)}},v=(e,t)=>{if(t){e.innerText="Error trying to get a quote, please restart",e.classList.remove("hide");return}e.innerText="",e.classList.add("hide")},L=(e,t)=>{for(let r=0;r<e.length;r++)void 0===t[r]&&(e[r].classList.remove("correct"),e[r].classList.remove("incorrect")),t[r]===e[r].innerText?(e[r].classList.add("correct"),e[r].classList.remove("incorrect")):t[r]!==e[r].innerText&&void 0!==t[r]&&(e[r].classList.add("incorrect"),e[r].classList.remove("correct"))},x=(e,t,r)=>{""===r&&(e.forEach(e=>{e.classList.remove("active-character")}),e[0].classList.add("active-characer")),e[t]&&e[t].classList.add("active-character"),e[t-1]&&e[t-1].classList.remove("active-character"),e[t+1]&&e[t+1].classList.remove("active-character")},y=e=>Array.from(e).every(e=>e.classList.contains("correct")||e.classList.contains("incorrect")),_=()=>{let e=0,t=0;return l.forEach(t=>{t.classList.contains("correct")&&!g(t)&&(e+=1)}),l.forEach(e=>{e.classList.contains("correct")&&(t+=1)}),[e,t]},f=(e,t,r,i)=>{c.innerText=`Not counting spaces: ${e.toFixed(0)}%`,a.innerText=`Counting spaces: ${t.toFixed(0)}%`,s.innerText=`Not counting spaces: ${r.toFixed(1)}`,n.innerText=`Counting spaces: ${i.toFixed(1)}`},m=e=>{T+=1,e.innerText=`${T} seconds`},q=(e,t,r,c)=>{let s=Array.from(r).filter(e=>!g(e));return[e/s.length*100,t/r.length*100,e/c,t/c,]};function g(e){return!/[^\t\n\r ]/.test(e.textContent)}let T=0,S=null;r.addEventListener("input",()=>{S||(S=setInterval(()=>{m(e)},1e3));let t=r.value;if(x(l,t.length,t),L(l,t),y(l)){let[c,s]=_(),[a,n,i,o,]=q(c,s,l,T);f(a,n,i,o),d(r,t,!0),clearInterval(S),S=null}});let E=()=>{o.blur(),r.focus()};o.addEventListener("click",()=>{v(i,!1),T=0,e.innerText=`${T} seconds`,E(),f(0,0,0,0),clearInterval(S),S=null,p()}),p()})();